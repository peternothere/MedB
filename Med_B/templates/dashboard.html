{% load static %}

<!DOCTYPE html>
<html>
<head>
	<title>MED-B - dashboard</title>

  <link rel = "icon" href = "{% static 'img/med-b-icon.png' %}" type = "image/png">
	<!-- Bootstrap 5 CSS -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.1.3/css/bootstrap.min.css">

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/boxicons@latest/css/boxicons.min.css">

  <link rel="stylesheet" href="{% static 'dashboard/css/styles.css' %}">
  <link href='https://unpkg.com/boxicons@2.1.1/css/boxicons.min.css' rel='stylesheet'>
	<link rel="stylesheet" href="{% static 'dashboard/css/style.css' %}">


	<style>
		.carousel {
			height: 25%;
			width: 70%;
			margin: auto;
			box-shadow: 0px 0px 10px rgba(0,0,0,0.5);
			background-color: white;
		}

    .dark-shadow {
			box-shadow: 0px 0px 10px rgba(0,0,0,0.5);
      margin-bottom: 100px;
      border-radius: 5px;
      height: 25%;
	    width: 70%;
      text-align: center;
		}

    
    .active {
      background-color: #4caf50;
      color: white;
    }

    .m{
      margin: 20px auto;
      padding: 20px 40px;
    }


    #head{
      width:50%;
      display:flex;
      margin-left:-40px;
    }

    .alarm-section{
      width: 30%;
      height:30px;
      margin-left:550px;
      margin-top:-50px;
  }

  #btn_alarm{
    margin-left:250px;
    font-size:40px;
    background:transparent;
    border:none;
  }

  .reminder{
    display:flex;
    flex:left;
  }

  .reminder-block{
    height:350px;
    width:800px;
    margin-top:50px;
    gap:2.5rem;
    display:flex;
    flex:left;
  }

  .rem{
    height:200px;
    width:250px;
    padding:10px;
    border: 1px solid;
  }

  .rem h4{
    margin-top:10px;
    font-size:30px;
  }

  .rem h5{
    margin-top:10px;
  }

  .rem button{
    margin-top:20px;
    margin-left:15%;
    width:150px;
    height:40px;
  }

  #alarm-set{
    height:300px;
    width:400px;
    border: 1px solid;
    margin-left:900px;
    margin-top:-380px;
    display: none;
    flex-direction: column;
  }

  #medlab{
    font-size:20px;
    margin-left: 15%;
  }

  #time{
    width:200px;
    height:40px;
    font-size:20px;
    margin-top:20px;
    margin-left: 15%;
  }

  #text{
    margin-top:20px;
    margin-left: 15%;
    width:300px;
    height:40px;
  }

  #btn{
    margin-top:40px;
    margin-left: 35%;
    width:150px;
    height:40px;
  }

  .radio-button{
    display: flex;
    gap: 2rem;
    margin-left: 15%;
    font-size: 15px;
    margin-top:10px;
  }

  .rem-text{
    display:flex;
  }

  .snooze{
    background:none;
    border:none;
    animation: pulse is infinite;
  }

  button.snooze{
    height: 25px;
    width: 19px;
    margin-block-end: auto;
    margin-left: 82px;
    margin-top: -1px;
    font-size: 21px;
  }


    .card{
      margin: 20px auto;
      padding: 20px 40px;
    }
	</style>
</head>
<body>
  
  <header class="header" id="header">
            <nav class="nav container">
              <a href="{% url 'index' %}" class="nav__logo"><span class="fs-8">MED</span>-B</a>
              <div class="nav__menu" id="nav-menu">
              
              
              
                
                    <ul class="nav__list">
                        <li class="nav__item">
                            <a href="#home" class="nav__link active-link">
                                <i class='bx bx-home-alt nav__icon'></i>
                                <span class="nav__name">Home</span>
                            </a>
                        </li>
                        
                        <!-- <li class="nav__item">
                            <a href="#services" class="nav__link">
                                <i class='bx bx-user nav__icon'></i>
                                <span class="nav__name">Services</span>
                            </a>
                        </li> -->

                        <li class="nav__item">
                            <a href="#medications" class="nav__link">
                                <i class='bx bx-book-alt nav__icon'></i>
                                <span class="nav__name">Medications</span>
                            </a>
                        </li>

                        <li class="nav__item">
                          <a href="{% url 'upload'%}" class="nav__link">
                              <i class='bx bx-book-alt nav__icon'></i>
                              <span class="nav__name">MedRecords</span>
                          </a>
                      </li>

                        

                        <li class="nav__item">
                          <a href="{% url 'profile' %}" class="nav__link">
                              <i class='bx bx-briefcase-alt nav__icon'></i>
                              <span class="nav__name">Profile</span>
                          </a>
                      </li>

                        <li class="nav__item">
                            <a href="{% url 'logout' %}" class="nav__link">
                                <i class='bx bx-message-square-detail nav__icon'></i>
                                <span class="nav__name">Logout </span>
                            </a>
                        </li>
                    </ul>
                </div>
           

                <!-- <img src="assets/img/perfil.png" alt="" class="nav__img"> -->
            </nav>
        </header>

  <br>
  <div class="container">

  <main>
    <!--=============== HOME ===============-->
    <section class="container section " id="home">
      <div class="card dark-shadow">
        <p id="date" style:"margin:0 display:inline;"></p>
        <h1 id="greeting"></h1>
        <h1>{{ user.username }}</h1>
         
      </div>
    </section>
    <br>
    <br>
    <br>
    <br>
    <!--=============== SERVICES ===============-->
    <section class="container section section__height" id="services">
      <div class="container">
        <div id="myCarousel" class="carousel slide" data-bs-ride="carousel">
          <div class="carousel-indicators">
            <button type="button" data-bs-target="#myCarousel" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
            <button type="button" data-bs-target="#myCarousel" data-bs-slide-to="1" aria-label="Slide 2"></button>
            <button type="button" data-bs-target="#myCarousel" data-bs-slide-to="2" aria-label="Slide 3"></button>
          </div>
          <div class="carousel-inner">
            <div class="carousel-item active">
              <a href="">
                <img src="https://images.unsplash.com/photo-1527613426441-4da17471b66d?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=852&q=80" class="d-block w-100" alt="Slide 1">
                <div class="carousel-caption d-none d-md-block">
                  <h5><b>Disease Prediction</b></h5>
                  <p>Allows users to enter their symptoms and receive an accurate prediction about the disease they might be¬†suffering¬†from.</p>
                </div>
              </a>
              
            </div>
            <div class="carousel-item">
              <a href="">
                <img src="https://images.unsplash.com/photo-1587854692152-cbe660dbde88?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=869&q=80" class="d-block w-100" alt="Slide 2">
                <div class="carousel-caption d-none d-md-block">
                  <h5>Home remedies/Medicinal choice</h5>
                  <p>Suggests alternative medicines for common illnesses such as common cold and flu, making it easier for users to select the right medicine for their condition. </p>
                </div>
              </a>
              
            </div>
            <div class="carousel-item">
              <a href="">
                <img src="https://images.unsplash.com/photo-1507146153580-69a1fe6d8aa1?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=870&q=80" class="d-block w-100" alt="Slide 3">
                <div class="carousel-caption d-none d-md-block">
                  <h5>AI Assistant</h5>
                  <p>The AI assistant feature is an automated voice recognizing bot that helps sort records, schedule appointments, and provide reminders for medicine¬†intakes.</p>
                </div>
              </a>
            </div>
          </div>
          <button class="carousel-control-prev" type="button" data-bs-target="#myCarousel" data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Previous</span>
          </button>
          <button class="carousel-control-next" type="button" data-bs-target="#myCarousel" data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Next</span>
          </button>
        </div>
      </div>
      <br>
    </section>
    
    
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <!--=============== Medications ===============-->
  <section class="container section section__height" id="medications">
      <div class="m">
        <h1 id="head">Medications:</h1>
        <div class="alarm-section">
          <button id="btn_alarm"><i class='bx bx-alarm-add'></i></button>
        </div>
      </div>
        <div class="reminder"> 
        <div class="reminder-block" id="rev">
          <div class="rem" id="alarm1">
            <div class="rem-text">
              <label>Reminder 1</label>
              <button class="snooze" id="bell1" onclick="toggleAnimation"><i class='bx bx-alarm-snooze'></i></button>  
            </div>
            <h4 id="rem1" data-flag="off"></h4>
            <h5 id="a1"></h5>
            <button class="cancel"  onclick="clear_alarm(1)">Mark as Taken</button>
          </div>
          <div class="rem" id="alarm2">
          <div class="rem-text">
            <label>Reminder 2</label>
            <button class="snooze" id="bell2" onclick="toggleAnimation"><i class='bx bx-alarm-snooze'></i></button>  
          </div>
          <h4 id="rem2" data-flag="off"></h4>
          <h5 id="a2"></h5>
          <button class="cancel" onclick="clear_alarm(2)">Mark as Taken</button>
        </div>
        <div class="rem" id="alarm3">
        <div class="rem-text">
          <label>Reminder 2</label>
          <button class="snooze" id="bell3" onclick="toggleAnimation"><i class='bx bx-alarm-snooze'></i></button>  
        </div>
        <h4 id="rem3" data-flag="off"></h4>
        <h5 id="a3"></h5>
        <button class="cancel" onclick="clear_alarm(3)">Mark as Taken</button>
        </div>
      </div>
    </div>
    <div id="alarm-set">
      <label id="medlab">Set Medications:</label>
      <input type="time" id="time">
      <div class="radio-button" id="radio">
        <div class="morning">
            <label for="mrng">Morning:</label>
            <input type="radio" id="mrng" name="group1"  value="1">    
        </div>
        <div class="morning">
            <label for="mrng">Afternoon:</label>
            <input type="radio" id="afn" name="group1"  value="2">>    
        </div>
        <div class="morning">
            <label for="mrng">Night:</label>
            <input type="radio" id="nyt" name="group1"  value="3">>    
        </div>
    </div>
      <input type="text" id="text" placeholder="Specify Med">
      <button id="btn" onclick="alarm()">Set Alarm</button>
    </div>
  </section>
  <br>
  <br>
  <br>
  <br>
    
    

</main>
</div>
<div class="container">
  <div class="chatbox-wrapper">
		<div class="chatbox-toggle">
			<i class='bx bx-message-dots'></i>
		</div>
		<div class="chatbox-message-wrapper">
			<div class="chatbox-message-header">
				<div class="chatbox-message-profile">
					<img src="{% static 'img/med-b-icon.png' %}" alt="" class="chatbox-message-image">
					<div>
						<h4 class="chatbox-message-name">Med-B</h4>
						<p class="chatbox-message-status">online</p>
					</div>
				</div>
				<div class="chatbox-message-dropdown">
					<i class='bx bx-dots-vertical-rounded chatbox-message-dropdown-toggle'></i>
					<ul class="chatbox-message-dropdown-menu">
						<li>
							<a href="#">Search</a>
						</li>
						<li>
							<a href="#">Report</a>
						</li>
					</ul>
				</div>
			</div>
			<div class="chatbox-message-content">
				<h4 class="chatbox-message-no-message">You don't have message yet!</h4>
				
			</div>
			<div class="chatbox-message-bottom">
				<form action="/save_user_input/" method="POST" class="chatbox-message-form">
          
					<textarea rows="1" placeholder="Type message..." class="chatbox-message-input"></textarea>&nbsp;&nbsp;&nbsp;
					<button type="submit" class="chatbox-message-submit"><i class='bx bx-send' ></i></button>
				</form>
			</div>
		</div>
	</div>
	

	
</div>
<!--=============== MAIN JS ===============-->
<script src="{% static 'dashboard/js/main.js' %}"></script>
  
<script src="{% static 'dashboard/js/script.js' %}"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/brython@3.9.6/brython.js"></script>

	<!-- Bootstrap 5 JS -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.1.3/js/bootstrap.bundle.min.js"></script>
  <script>
    // Get the current date
    const now = new Date();
    
    // Get the month as a sentence
    const months = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
    const month = months[now.getMonth()];

    // Get the time of day
    const hour = now.getHours();
    let timeOfDay;
    if (hour < 12) {
      timeOfDay = 'Good morning,';
    } else if (hour < 18) {
      timeOfDay = 'Good afternoon,';
    } else {
      timeOfDay = 'Good evening,';
    }

    // Format the date
    const date = `Today,${now.getDate()}  ${month}  ${now.getFullYear()}`;

    // Display the greeting and date
    document.getElementById('greeting').textContent = timeOfDay;
    document.getElementById('date').textContent = date;
    //Display and hide alarm setting
    const btn = document.getElementById('btn_alarm');

    btn.addEventListener('click', () => {
    const setalarm= document.getElementById('alarm-set');

    if (setalarm.style.display == 'none') {
      // üëáÔ∏è this SHOWS the form
      setalarm.style.display = 'flex';
    } else {
      // üëáÔ∏è this HIDES the form
      setalarm.style.display = 'none';
    }
    });

    //button wise routine
    var radiobutton=document.getElementById('radio');
    radiobutton.addEventListener('click', function() {
      radbutt();
    });

    function radbutt()
    {
      var radioButtons = document.getElementsByName('group1');
      console.log(radioButtons);
          for (var i = 0; i < radioButtons.length; i++) {
            if (radioButtons[i].checked) {
              var selectedValue = radioButtons[i].value;
              console.log(selectedValue);
              break;  // Exit the loop since we found the selected radio button
            }
          }
          var timeInput = document.getElementById('time');
  
          if(selectedValue==1)
          {
            timeInput.value='09:00';
          }
          else if(selectedValue==2)
          {
            timeInput.value='12:30';
          }
          else if(selectedValue==3)
          {
            timeInput.value='21:00';
          } 
    }

    
    //alarm
    function alarm()
    {
        var remainder1=document.getElementById('rem1');
        var flag1=remainder1.getAttribute('data-flag');
        var remainder2=document.getElementById('rem2');
        var flag2=remainder2.getAttribute('data-flag');
        var remainder3=document.getElementById('rem3');
        var flag3=remainder3.getAttribute('data-flag');
  
        var al1=document.getElementById('a1');
        var al2=document.getElementById('a2');
        var al3=document.getElementById('a3');

        var bell1=document.getElementById('bell1');
        var bell2=document.getElementById('bell2');
        var bell3=document.getElementById('bell3');
  
        var alarminput=document.getElementById('time').value;
        if (alarminput =='') {
            alert('Please enter a valid alarm time');
            return;
        }
        var now = new Date();
        var alarm = new Date(now.toDateString() + ' ' + alarminput);
        var timedif = alarm - now;
        if(timedif<0){
            alert('Please choose a time in the future');
            return;
        }
        var text=document.getElementById('text').value;

        if(flag1=='off')
        {
          remainder1.textContent=text;
          remainder1.setAttribute('data-flag','on');

          if(alarminput<'12:00')
          {
            al1.textContent=alarminput+" Morning";
          }
          else if(alarminput<'16:00')
          {
            al1.textContent=alarminput+" Afternoon";
          }
          else if(alarminput<'19:00')
          {
            al1.textContent=alarminput+" Evening";
          }
          else
          {
            al1.textContent=alarminput+" Night";
          }
          
          cancel_alarm1=setTimeout(function(){
            tsnooze(bell1);
            var audio =new Audio('audio.mp3');
            audio.play();
            alert('Its time for Meds');
          },timedif);
        }
        else if(flag2=='off')
        {
          remainder2.textContent=text;
          remainder2.setAttribute('data-flag','on');

          if(alarminput<'12:00')
          {
            al2.textContent=alarminput+" Morning";
          }
          else if(alarminput<'16:00')
          {
            al2.textContent=alarminput+" Afternoon";
          }
          else if(alarminput<'19:00')
          {
            al2.textContent=alarminput+" Evening";
          }
          else
          {
            al2.textContent=alarminput+" Night";
          }

          cancel_alarm2=setTimeout(function(){
            tsnooze(bell2);
            alert('Wake Up');
          },timedif);
        }
        else if(flag3=='off')
        {
          remainder3.textContent=text;
          remainder3.setAttribute('data-flag','on');


          if(alarminput<'12:00')
          {
            al3.textContent=alarminput+" Morning";
          }
          else if(alarminput<'16:00')
          {
            al3.textContent=alarminput+" Afternoon";
          }
          else if(alarminput<'19:00')
          {
            al3.textContent=alarminput+" Evening";
          }
          else
          {
            al3.textContent=alarminput+" Night";
          }

          cancel_alarm3=setTimeout(function(){
            tsnooze(bell3);
            alert('Wake Up');
          },timedif);
        }
        else{
          alert('All reminders are set');
        }
        clear_set();
    }

   function tsnooze(sn)
    {
      setTimeout(function (){
        sn.style.color="red";
      },1000);
    }

    function clear_set()
    {
      document.getElementById('time').value="";
      document.getElementById('text').value="";
      const setalarm= document.getElementById('alarm-set');
      setalarm.style.display = 'none';
    }


  //clear alarm()
  function clear_alarm(num)
  {
    var remainder1=document.getElementById('rem1');
    var flag1=remainder1.getAttribute('data-flag');
    var remainder2=document.getElementById('rem2');
    var flag2=remainder2.getAttribute('data-flag');
    var remainder3=document.getElementById('rem3');
    var flag3=remainder3.getAttribute('data-flag');

    var al1=document.getElementById('a1');
    var al2=document.getElementById('a2');
    var al3=document.getElementById('a3');

    var bell1=document.getElementById('bell1');
    var bell2=document.getElementById('bell2');
    var bell3=document.getElementById('bell3');

    if(num==1)
    {
      remainder1.textContent='';
      remainder1.setAttribute('data-flag','off');
      al1.textContent='';
      bell1.style.color="black";

      clearTimeout(cancel_alarm1);
    }
    else if(num==2)
    {
      remainder2.textContent='';
      remainder2.setAttribute('data-flag','off');
      al2.textContent='';
      bell2.style.color="black";
      clearTimeout(cancel_alarm2);
    }
    else
    {
      remainder3.textContent='';
      remainder3.setAttribute('data-flag','off');
      al3.textContent='';
      bell3.style.color="black";
      clearTimeout(cancel_alarm3);
    }
  }
  </script>
</body>
</html>